{"ast":null,"code":"\"use strict\";\n\n/*!\n * Copyright 2017 Google Inc. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Snapshot = void 0;\nconst subscription_1 = require(\"./subscription\");\nconst util_1 = require(\"./util\");\n/**\n * A Snapshot object will give you access to your Cloud Pub/Sub snapshot.\n *\n * Snapshots are sometimes retrieved when using various methods:\n *\n * - {@link PubSub#getSnapshots}\n * - {@link PubSub#getSnapshotsStream}\n * - {@link PubSub#snapshot}\n *\n * Snapshots may be created with:\n *\n * - {@link Subscription#createSnapshot}\n *\n * You can use snapshots to seek a subscription to a specific point in time.\n *\n * - {@link Subscription#seek}\n *\n * @class\n *\n * @example\n * ```\n * //-\n * // From {@link PubSub#getSnapshots}:\n * //-\n * pubsub.getSnapshots((err, snapshots) => {\n *   // `snapshots` is an array of Snapshot objects.\n * });\n *\n * //-\n * // From {@link PubSub#getSnapshotsStream}:\n * //-\n * pubsub.getSnapshotsStream()\n *   .on('error', console.error)\n *   .on('data', (snapshot) => {\n *     // `snapshot` is a Snapshot object.\n *   });\n *\n * //-\n * // From {@link PubSub#snapshot}:\n * //-\n * const snapshot = pubsub.snapshot('my-snapshot');\n * // snapshot is a Snapshot object.\n *\n * //-\n * // Create a snapshot with {module:pubsub/subscription#createSnapshot}:\n * //-\n * const subscription = pubsub.subscription('my-subscription');\n *\n * subscription.createSnapshot('my-snapshot', (err, snapshot) => {\n *   if (!err) {\n *     // `snapshot` is a Snapshot object.\n *   }\n * });\n *\n * //-\n * // Seek to your snapshot:\n * //-\n * const subscription = pubsub.subscription('my-subscription');\n *\n * subscription.seek('my-snapshot', (err) => {\n *   if (err) {\n *     // Error handling omitted.\n *   }\n * });\n * ```\n */\nclass Snapshot {\n  constructor(parent, name) {\n    this.parent = parent;\n    this.name = Snapshot.formatName_(parent.projectId, name);\n  }\n  delete(callback) {\n    const reqOpts = {\n      snapshot: this.name\n    };\n    this.parent.request({\n      client: 'SubscriberClient',\n      method: 'deleteSnapshot',\n      reqOpts\n    }, callback);\n  }\n  /*@\n   * Format the name of a snapshot. A snapshot's full name is in the format of\n   * projects/{projectId}/snapshots/{snapshotName}\n   *\n   * @private\n   */\n  static formatName_(projectId, name) {\n    return 'projects/' + projectId + '/snapshots/' + name.split('/').pop();\n  }\n  create(optsOrCallback, callback) {\n    if (!(this.parent instanceof subscription_1.Subscription)) {\n      throw new Error('This is only available if you accessed this object through Subscription#snapshot');\n    }\n    const options = typeof optsOrCallback === 'object' ? optsOrCallback : {};\n    callback = typeof optsOrCallback === 'function' ? optsOrCallback : callback;\n    return this.parent.createSnapshot(this.name, options, (err, snapshot, resp) => {\n      if (err) {\n        callback(err, null, resp);\n        return;\n      }\n      Object.assign(this, snapshot);\n      callback(null, this, resp);\n    });\n  }\n  seek(gaxOpts, callback) {\n    if (!(this.parent instanceof subscription_1.Subscription)) {\n      throw new Error('This is only available if you accessed this object through Subscription#snapshot');\n    }\n    return this.parent.seek(this.name, gaxOpts, callback);\n  }\n}\nexports.Snapshot = Snapshot;\n/*! Developer Documentation\n *\n * Existing async methods (except for streams) will return a Promise in the event\n * that a callback is omitted. Future methods will not allow for a callback.\n * (Use .then() on the returned Promise instead.)\n */\n(0, util_1.promisifySome)(Snapshot, Snapshot.prototype, ['delete', 'create', 'seek']);","map":{"version":3,"names":["subscription_1","require","util_1","Snapshot","constructor","parent","name","formatName_","projectId","delete","callback","reqOpts","snapshot","request","client","method","split","pop","create","optsOrCallback","Subscription","Error","options","createSnapshot","err","resp","Object","assign","seek","gaxOpts","exports","promisifySome","prototype"],"sources":["../../src/snapshot.ts"],"sourcesContent":[null],"mappings":";;AAAA;;;;;;;;;;;;;;;;;;;AA0BA,MAAAA,cAAA,GAAAC,OAAA;AACA,MAAAC,MAAA,GAAAD,OAAA;AAWA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkEA,MAAaE,QAAQ;EAInBC,YAAYC,MAA6B,EAAEC,IAAY;IACrD,IAAI,CAACD,MAAM,GAAGA,MAAM;IACpB,IAAI,CAACC,IAAI,GAAGH,QAAQ,CAACI,WAAW,CAACF,MAAM,CAACG,SAAS,EAAEF,IAAI,CAAC;EAC1D;EAyBAG,MAAMA,CAACC,QAAwB;IAC7B,MAAMC,OAAO,GAAG;MACdC,QAAQ,EAAE,IAAI,CAACN;KAChB;IAED,IAAI,CAACD,MAAM,CAACQ,OAAO,CACjB;MACEC,MAAM,EAAE,kBAAkB;MAC1BC,MAAM,EAAE,gBAAgB;MACxBJ;KACD,EACDD,QAAS,CACV;EACH;EAEA;;;;;;EAMA,OAAOH,WAAWA,CAACC,SAAiB,EAAEF,IAAY;IAChD,OAAO,WAAW,GAAGE,SAAS,GAAG,aAAa,GAAGF,IAAI,CAACU,KAAK,CAAC,GAAG,CAAC,CAACC,GAAG,EAAE;EACxE;EA0CAC,MAAMA,CACJC,cAAqD,EACrDT,QAAiC;IAEjC,IAAI,EAAE,IAAI,CAACL,MAAM,YAAYL,cAAA,CAAAoB,YAAY,CAAC,EAAE;MAC1C,MAAM,IAAIC,KAAK,CACb,kFAAkF,CACnF;;IAGH,MAAMC,OAAO,GAAG,OAAOH,cAAc,KAAK,QAAQ,GAAGA,cAAc,GAAG,EAAE;IACxET,QAAQ,GAAG,OAAOS,cAAc,KAAK,UAAU,GAAGA,cAAc,GAAGT,QAAQ;IAE3E,OAAO,IAAI,CAACL,MAAM,CAACkB,cAAc,CAC/B,IAAI,CAACjB,IAAI,EACTgB,OAAO,EACP,CAACE,GAAG,EAAEZ,QAAQ,EAAEa,IAAI,KAAI;MACtB,IAAID,GAAG,EAAE;QACPd,QAAS,CAACc,GAAG,EAAE,IAAI,EAAEC,IAAI,CAAC;QAC1B;;MAEFC,MAAM,CAACC,MAAM,CAAC,IAAI,EAAEf,QAAQ,CAAC;MAC7BF,QAAS,CAAC,IAAI,EAAE,IAAI,EAAEe,IAAI,CAAC;IAC7B,CAAC,CACF;EACH;EAgCAG,IAAIA,CACFC,OAAoC,EACpCnB,QAAuB;IAEvB,IAAI,EAAE,IAAI,CAACL,MAAM,YAAYL,cAAA,CAAAoB,YAAY,CAAC,EAAE;MAC1C,MAAM,IAAIC,KAAK,CACb,kFAAkF,CACnF;;IAEH,OAAO,IAAI,CAAChB,MAAM,CAACuB,IAAI,CAAC,IAAI,CAACtB,IAAI,EAAEuB,OAAuB,EAAEnB,QAAS,CAAC;EACxE;;AApKFoB,OAAA,CAAA3B,QAAA,GAAAA,QAAA;AAuKA;;;;;;AAMA,IAAAD,MAAA,CAAA6B,aAAa,EAAC5B,QAAQ,EAAEA,QAAQ,CAAC6B,SAAS,EAAE,CAAC,QAAQ,EAAE,QAAQ,EAAE,MAAM,CAAC,CAAC"},"metadata":{},"sourceType":"script","externalDependencies":[]}